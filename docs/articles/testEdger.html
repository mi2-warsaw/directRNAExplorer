<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Likelihood ratio test and quasi-likelihood F-test for detecting changed genes • directRNAExplorer</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><meta property="og:title" content="Likelihood ratio test and quasi-likelihood F-test for detecting changed genes">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">directRNAExplorer</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Package_presentation.html">directRNAExplorer - functionalities</a>
    </li>
    <li>
      <a href="../articles/testEdger.html">Likelihood ratio test and quasi-likelihood F-test for detecting changed genes</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Likelihood ratio test and quasi-likelihood F-test for detecting changed genes</h1>
                        <h4 class="author">Aleksandra Grudziąż</h4>
            
            <h4 class="date">19 kwietnia 2018</h4>
      
      
      <div class="hidden name"><code>testEdger.Rmd</code></div>

    </div>

    
    
<div id="data" class="section level1">
<h1 class="hasAnchor">
<a href="#data" class="anchor"></a>Data</h1>
<p>To prepare the following tables with counts, I used the Araport database, which is a more accurate version of the TAIR10 database, which I used in my previous analyzes. This database better assigns parts to the corresponding genes. In addition, counts take into account the distance between 300b and the longer 3’UTR for each gene we have more than 5 counts. If so, these counts are also counted as readings for the gene. In the analysis below, we look for differences between the wild subtype and the brm mutant.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="st">"countsAll_new.rda"</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(directRNAExplorer)
<span class="kw">library</span>(dplyr)</code></pre></div>
</div>
<div id="testing-diffrences-in-genes" class="section level1">
<h1 class="hasAnchor">
<a href="#testing-diffrences-in-genes" class="anchor"></a>Testing diffrences in genes</h1>
<p>As before, before testing we have to choose the “appropriate” genes, that is, those for whom the quality of sequencing satisfies us. We assumed that for wt a good sequencing for the gene is where at least 2 out of 3 samples we have more than 9 readings, and for mutations brm if at least 3 out of 4 samples we have more than 9 readings. In addition, we are looking for genes that have many counts in one of the subtypes and hardly any at all.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">genesTest &lt;-<span class="kw">c</span>() 
countsWithCondition &lt;-<span class="st"> </span>countsAll_new


<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span><span class="kw">ncol</span>(countsAll)){
  countsWithCondition[,i] &lt;-<span class="st"> </span><span class="kw">ifelse</span>(countsAll[,i]<span class="op">&gt;=</span><span class="dv">9</span>, <span class="dv">1</span>, <span class="dv">0</span>)
}

allCounts_<span class="dv">2</span> &lt;-<span class="st"> </span>countsWithCondition[,<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>)]
genes &lt;-<span class="st"> </span>allCounts_<span class="dv">2</span>[,<span class="dv">1</span>]

allCountsTransposed &lt;-<span class="st"> </span><span class="kw">t</span>(allCounts_<span class="dv">2</span>[,<span class="op">-</span><span class="dv">1</span>])
allCountsTransposed &lt;-<span class="st"> </span><span class="kw">data.frame</span>(allCountsTransposed)
<span class="kw">colnames</span>(allCountsTransposed)&lt;-<span class="st"> </span>genes

allCountsTransposed<span class="op">$</span>type &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">"wt"</span>, <span class="dv">3</span>), <span class="kw">rep</span>(<span class="st">"brm"</span>, <span class="dv">4</span>))
allCountsTransposed &lt;-<span class="st"> </span>allCountsTransposed[,<span class="kw">c</span>(<span class="kw">ncol</span>(allCountsTransposed), <span class="dv">1</span><span class="op">:</span>(<span class="kw">ncol</span>(allCountsTransposed)<span class="op">-</span><span class="dv">1</span>))]

sums &lt;-<span class="st"> </span><span class="kw">aggregate</span>(. <span class="op">~</span><span class="st"> </span>type, <span class="dt">data=</span>allCountsTransposed, <span class="dt">FUN=</span>sum)

<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span><span class="kw">ncol</span>(allCountsTransposed)){
  <span class="cf">if</span>(((sums[<span class="dv">1</span>,i]<span class="op">&gt;=</span><span class="dv">3</span>) <span class="op">&amp;</span><span class="st"> </span>(sums[<span class="dv">2</span>,i]<span class="op">&gt;=</span><span class="dv">2</span>)) <span class="op">||</span><span class="st"> </span>((sums[<span class="dv">1</span>,i]<span class="op">&gt;=</span><span class="dv">3</span>) <span class="op">&amp;</span><span class="st"> </span>(sums[<span class="dv">2</span>,i]<span class="op">==</span><span class="dv">0</span>))<span class="op">||</span>((sums[<span class="dv">1</span>,i]<span class="op">==</span><span class="dv">0</span>) <span class="op">&amp;</span><span class="st"> </span>(sums[<span class="dv">2</span>,i]<span class="op">&gt;=</span><span class="dv">2</span>))){
    genesTest[i] &lt;-<span class="st"> </span><span class="kw">colnames</span>(allCountsTransposed)[i] 
  }<span class="cf">else</span>{
    genesTest[i] &lt;-<span class="st"> </span><span class="ot">NA</span>
  }
}

genesTest2&lt;-<span class="st"> </span><span class="kw">na.omit</span>(genesTest)

countsTest &lt;-<span class="st"> </span>countsAll_new[,<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>)]
countsTest &lt;-<span class="st"> </span>countsTest[<span class="kw">which</span>(countsTest<span class="op">$</span>name <span class="op">%in%</span><span class="st"> </span>genesTest2),]

countsTest2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">t</span>(countsTest[,<span class="op">-</span><span class="dv">1</span>]))
<span class="kw">colnames</span>(countsTest2) &lt;-<span class="st"> </span>countsTest<span class="op">$</span>name</code></pre></div>
<div id="likelihood-ratio-test" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood-ratio-test" class="anchor"></a>Likelihood ratio test</h2>
<p>For selected genes we perform a likelihood ratio test, in order to find genes for which the number of readings has changed significantly divided into two groups - wt and brm. The <code>testEdger()</code> is based on <code>edgeR</code> R package. We choose the <code>type</code> “lrt”" to perform likelihood ratio test.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cond  &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">"wt"</span>, <span class="dv">3</span>), <span class="kw">rep</span>(<span class="st">"brm"</span>, <span class="dv">4</span>))
test&lt;-<span class="kw"><a href="../reference/edgerTest.html">edgerTest</a></span>(countsTest2, <span class="dt">condition =</span> cond, <span class="dt">type=</span><span class="st">"lrt"</span>)</code></pre></div>
<p>To find the most changed genes, we will focus only on those that have a small pvalue and fold greater than 1.6.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
testFiltered &lt;-<span class="st"> </span><span class="kw">filter</span>(test, pvalue<span class="op">&lt;</span><span class="fl">0.05</span>)
testFiltered &lt;-<span class="st"> </span><span class="kw">filter</span>(testFiltered, <span class="kw">abs</span>(log2FoldChange)<span class="op">&gt;</span><span class="fl">0.32</span>)
testFiltered &lt;-<span class="st"> </span><span class="kw">arrange</span>(testFiltered, pvalue)
testFiltered &lt;-<span class="st"> </span><span class="kw">arrange</span>(testFiltered, <span class="kw">desc</span>(log2FoldChange))

<span class="kw">head</span>(testFiltered, <span class="dv">8</span>)</code></pre></div>
<pre><code>##   log2FoldChange   logCPM        LR       pvalue        id
## 1       5.450000 8.894925 11.661442 6.380886e-04 AT3G27700
## 2       5.106717 9.030065 12.863734 3.350115e-04 AT4G28740
## 3       4.345750 7.210490 12.027947 5.240878e-04 AT4G16710
## 4       4.226212 5.912666 91.647379 1.035830e-21 AT3G01345
## 5       3.976154 7.673624  9.694307 1.848398e-03 AT4G33000
## 6       3.707366 5.058775 12.833371 3.404918e-04 AT2G44850
## 7       3.697730 8.318383 10.154933 1.439156e-03 AT2G21320
## 8       3.247221 7.173796  6.242492 1.247209e-02 AT5G66180</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nrow</span>(testFiltered)</code></pre></div>
<pre><code>## [1] 977</code></pre>
</div>
<div id="quasi-likelihood-f-test" class="section level2">
<h2 class="hasAnchor">
<a href="#quasi-likelihood-f-test" class="anchor"></a>Quasi-likelihood F-test</h2>
<p>As before, we use the <code>testEdger()</code> function to find differences in genes, but in this case we use the “qlt” value for the <code>type</code> argument.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cond  &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">"wt"</span>, <span class="dv">3</span>), <span class="kw">rep</span>(<span class="st">"brm"</span>, <span class="dv">4</span>))
test&lt;-<span class="kw"><a href="../reference/edgerTest.html">edgerTest</a></span>(countsTest2, <span class="dt">condition =</span> cond, <span class="dt">type=</span><span class="st">"qlf"</span>)</code></pre></div>
<p>To find the most changed genes, we will focus only on those that have a small pvalue and fold greater than 1.6.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
testFiltered &lt;-<span class="st"> </span><span class="kw">filter</span>(test, pvalue<span class="op">&lt;</span><span class="fl">0.05</span>)
testFiltered &lt;-<span class="st"> </span><span class="kw">filter</span>(testFiltered, <span class="kw">abs</span>(log2FoldChange)<span class="op">&gt;</span><span class="fl">0.32</span>)
testFiltered &lt;-<span class="st"> </span><span class="kw">arrange</span>(testFiltered, pvalue)
testFiltered &lt;-<span class="st"> </span><span class="kw">arrange</span>(testFiltered, <span class="kw">desc</span>(log2FoldChange))

<span class="kw">head</span>(testFiltered, <span class="dv">8</span>)</code></pre></div>
<pre><code>##   log2FoldChange   logCPM          F       pvalue        id
## 1       5.438035 8.894925   9.837701 1.499784e-02 AT3G27700
## 2       5.102942 9.030065  11.256455 1.093759e-02 AT4G28740
## 3       4.328831 7.210490  11.000285 1.155626e-02 AT4G16710
## 4       4.268851 5.912666 121.084082 6.628767e-06 AT3G01345
## 5       3.999903 7.673624   8.792226 1.928688e-02 AT4G33000
## 6       3.709251 8.318383   9.577522 1.594091e-02 AT2G21320
## 7       3.691858 5.058775  12.812294 7.961881e-03 AT2G44850
## 8       3.249631 7.173796   5.707854 4.581513e-02 AT5G66180</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nrow</span>(testFiltered)</code></pre></div>
<pre><code>## [1] 1045</code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#data">Data</a></li>
      <li>
<a href="#testing-diffrences-in-genes">Testing diffrences in genes</a><ul class="nav nav-pills nav-stacked">
<li><a href="#likelihood-ratio-test">Likelihood ratio test</a></li>
      <li><a href="#quasi-likelihood-f-test">Quasi-likelihood F-test</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Aleksandra Grudziaz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
